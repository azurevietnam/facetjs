<!DOCTYPE html>
<html>
  <head>
    <!--
    Forgive me but this is a prototype :-)
    -->
    <link rel="stylesheet/less" type="text/css" href="facet.less">
    <script src="lib/less-1.3.0.min.js"></script>
    <script src="http://underscorejs.org/underscore-min.js"></script>
    <script src="lib/d3.js"></script>
    <script src="facet.js"></script>
    <title>Facet v0.1</title>
  </head>

  <body>
    <div class="cont">
    </div>
    <script>
      window.data1 = (function() {
        var now, pick, w;
        pick = function(arr) {
          return arr[Math.floor(Math.random() * arr.length)];
        };
        now = Date.now();
        w = 100;
        return d3.range(400).map(function(i) {
          return {
            id: i,
            time: new Date(now + i * 13 * 1000),
            letter: 'ABC'[Math.floor(3 * i / 400)],
            number: pick([1, 10, 3, 4]),
            scoreA: i * Math.random() * Math.random(),
            scoreB: 10 * Math.random(),
            walk: w += Math.random() - 0.5 + 0.02
          };
        });
      })();

      var split = facet.split;
      var apply = facet.apply;
      var layout = facet.layout;
      var plot = facet.plot;
      var prop = facet.prop;
      var sort = facet.sort;
      var stage = facet.stage;

      var rect1 = facet.canvas('.cont', 800, 600, data1)
        .split('Letter', split.natural('letter'))
        .apply('avgScoreA', apply.average('scoreA'))
        .layout(layout.vertical({ size: prop('avgScoreA'), gap: 5 }))
        .plot(plot.rect({ color: 'none' }))
        .stage(stage.rectToPoint(0.5, 0.5)).plot(plot.text({ text: prop('Letter'), color: 'green' }))
        .render()
          // .split('Time', split.time.minute('time'))
          // .layout(layout.horizontal({ gap: 2 }))
          // .plot(plot.rect({ color: '#ccccff' }))
          // .plot(plot.text({ text: prop('Number'), color: 'red' }))


    </script>
  </body>
</html>
